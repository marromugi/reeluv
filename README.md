# reeluv

> [!IMPORTANT]
> このプロジェクトはデモプロジェクトです。
> This project is a demo.

ショーリール作成・管理アプリケーションの POC（Proof of Concept）です。
広告制作会社が複数のビデオクリップをまとめてショーリールを作成し、実際の放映時間や規格情報を管理できます。

## 実装所要時間

10時間程度

## 技術スタック

### フロントエンド

- Next.js 16
- React 19
- TailwindCSS 4
- SWR（データフェッチング）
- dnd-kit（ドラッグ&ドロップ）

> 技術選定コメント
> 比較的慣れている + よく使われていて AI が理解しやすそうなものを採用して、スピード感重視で実装しています。RSCは使えそうなところで使いつつ、データのキャッシュはクライアントサイド（swr）で実装しています。（認証が入った際にサーバーサイドのキャッシュ管理が煩雑 + 学習コストが高いため）

### バックエンド

- Hono（軽量 Web フレームワーク）
- Zod + OpenAPI（スキーマ検証・ドキュメント生成）
- Drizzle ORM + SQLite

> 技術選定コメント
> 比較的慣れている + よく使われていて AI が理解しやすそうなものを採用して、スピード感重視で実装しています。アーキテクチャはクリーンアーキテクチャに近いものを採用しています。PoCをベースに実装を進める場合でも、repositoryなど抽象化したものをベースに置き換えれば比較的素早く置き換え可能です。 OpenAPI を採用した理由は、フロントでのモック作成に役立てたかったことと、仮にモバイルアプリを作る場合などでも使い回しできるためです。（swift-openapi-generator など）

### 開発ツール

- TypeScript 5.7
- Vitest（テスト）
- Storybook（UIカタログ）
- Playwright（E2E・ビジュアルテスト）
- ESLint + Prettier

> 技術選定コメント
> テストは api / ロジック部分は Vitest 単体、UIが絡むインタラクション・アクセシビリティテストは Storybook + Vitest で実施しています。（VRTは今回は見送り）
> フロントも含む e2e テストは実装できていませんが、時間があれば対応予定です。また、カバレッジテストについても、時間を取りそうだったので今回は見送っています。

### 使用したAI

- Claude

> コメント
> 今回はベースの設計や技術選定周りを除いて、ほぼ全て`Claude`にコードを書いてもらっています。
> 基本的に出力は流し見で確認しつつ、詰まった点やイケてないかもと思った点は skills、agents、CLAUDE.md に記載して参照してもらうようにしています。（とはいえ、強制しすぎると逆に`Claude`が動きづらくなってしまうので、ベースは Claude のデフォルトのアウトプットを採用しています。）
> Claude 自身に間違いに気づいてもらうよう、テストは極力書くようにしています。フロントが少し手薄ですが、時間があれば Storybook を用いてインタラクションテストやE2Eのテストを拡充させたいです。
> UIについては、Figmaのデザインがある状態であれば Code Connect + MCP を用いて、再現性高くデザインを表現できるコンポーネントの設計を行いたいです。（今回はデザインがなかった & Figma が Pro でないため見送り）

## セットアップ

### 必要条件

- Node.js 22.18.0
- pnpm 10.26.1

### インストール

```bash
pnpm install
```

## クイックスタート

以下のコマンドでセットアップから開発サーバーの起動まで一括で実行できます。

```bash
pnpm startup
```

ブラウザで [http://localhost:3000](http://localhost:3000) にアクセスしてください。

## 開発

### 開発サーバーの起動

```bash
pnpm dev
```

### Storybook の起動

```bash
pnpm storybook
```

### テストの実行

```bash
pnpm test        # 全テスト実行
pnpm test:ui     # UI テスト
pnpm test:api    # API テスト
pnpm test:vrt    # ビジュアルリグレッションテスト
```

### リント・フォーマット

```bash
pnpm lint        # ESLint 実行
pnpm format      # Prettier でフォーマット
```

### ビルド

```bash
pnpm build
```

## プロジェクト構成

```
reeluv/
├── apps/
│   └── web/                    # Next.js メインアプリケーション
│       ├── src/
│       │   ├── api/            # バックエンド API（クリーンアーキテクチャ）
│       │   │   ├── application/  # ユースケース層
│       │   │   ├── domain/       # ドメイン層
│       │   │   ├── infrastructure/
│       │   │   └── route/        # ルートハンドラー
│       │   ├── app/            # Next.js App Router
│       │   ├── components/     # React コンポーネント
│       │   ├── hooks/          # カスタムフック
│       │   └── client/         # API クライアント
│       └── .storybook/
│
├── databases/
│   └── core/                   # Drizzle ORM + SQLite
│       ├── src/schema/         # テーブルスキーマ
│       └── drizzle/            # マイグレーション
│
├── docs/                       # ドキュメント
│   └── spec.md                 # 機能仕様書
│
└── packages/                   # 共有パッケージ
```

> コメント
> pnpm workspace による monorepo です。
> api は nextjs の Route Handler 上で Hono を動かす形で実装しています。
> api のプロジェクトを分離する場合でも、ほぼそのまま移行できます。
> docs は今回どうプロジェクトに配置していますが、安全に誰でも触れるようにしたい場合や複数プロジェクトで共有したい場合は、リポジトリを分けて submodule として利用できるようにしたいです

## 主な機能

- ショーリールの作成・編集・削除
- ビデオクリップの追加・削除・並べ替え
- ビデオ規格（PAL/NTSC）と解像度（SD/HD）の管理
- タイムコード形式での時間表示（`HH:MM:ss:ff`）
- ダークモード対応

## ビジネスルール

- 1 つのショーリール内で異なるビデオ規格の混在は不可
- 1 つのショーリール内で異なる解像度の混在は不可
- 互換性のあるクリップのみ追加可能

## ライセンス

Private
